<div class="row">
  <div class="col-xs-6">
    <h2 ng-if="!TemplatesController.isEdit">Create Template</h2>
    <h2 ng-if="TemplatesController.isEdit">Edit Template</h2>
  </div>
  <div class="col-xs-6 text-right">
    <button class="btn btn-success" ng-click="TemplatesController.save()">Save</button>
  </div>
</div>
<div ng-if="!TemplatesController.isEdit">
  <label class="label-control">Choose Templates</label>
  <select ng-model="TemplatesController.templateType" class="form-control">
    <option value="ETLBatch">ETL Batch</option>
    <option value="ETLRealtime">ETL Realtime</option>
  </select>

  <div ng-if="TemplatesController.templateType">
    <label class="label-control">Choose Plugin Type</label>
    <select ng-model="TemplatesController.pluginType" class="form-control">
      <option value="source">Source</option>
      <option value="transform">Transform</option>
      <option value="sink">Sink</option>
    </select>
  </div>

  <div ng-if="TemplatesController.pluginList.length > 0">
    <label class="label-control">Choose Plugin</label>
    <select ng-model="TemplatesController.pluginName" class="form-control">
      <option ng-repeat="plugin in TemplatesController.pluginList" value="{{plugin.name}}">{{plugin.name}}</option>
    </select>
  </div>
</div>

<div ng-if="TemplatesController.pluginName">
  <h3>Plugin Properties</h3>

  <label class="label-control">Template Name</label>
  <input type="text" class="form-control" ng-model="TemplatesController.pluginConfig.pluginTemplate">

  <div ng-repeat="group in TemplatesController.groups.position">
    <div class="widget-group-container">
      <h4>{{TemplatesController.groups[group].display}}</h4>
      <div ng-repeat="field in TemplatesController.groups[group].position">
        <div ng-if="field !== 'schema'">
          <div class="form-group">
            <label class="control-label"
                    ng-init="title=TemplatesController.groups[group].fields[field].info;description=TemplatesController.groups[group].fields[field].description">
              <span>{{TemplatesController.groups[group].fields[field].label}}</span>
              <span class="fa fa-info-circle"
                    tooltip="{{description}}"
                    tooltip-placement="right"
                    tooltip-append-to-body="true">
              </span>
              <span class="fa fa-asterisk" ng-if="TemplatesController.pluginConfig._backendProperties[field].required"></span>
            </label>
            <div>
              <div data-name="field"
                   class="my-widget-container"
                   data-model="TemplatesController.pluginConfig.properties[field]"
                   data-myconfig="TemplatesController.groups[group].fields[field]"
                   data-properties="TemplatesController.pluginConfig.properties"
                   widget-container>
              </div>

              <label class="label-control">Lock change?</label>
              <input type="checkbox" ng-model="TemplatesController.pluginConfig.lock[field]">
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div>
    <div class="output-schema">
      <h4>Output Schema</h4>

      <fieldset ng-disabled="TemplatesController.isDisabled">
        <my-schema-editor
          ng-model="TemplatesController.pluginConfig['outputSchema']"
          data-disabled="TemplatesController.pluginConfig.implicitSchema"
          ng-if="TemplatesController.pluginName !== 'Stream' && TemplatesController.pluginName !== 'Kafka'"></my-schema-editor>
        <my-stream-properties
          ng-model="TemplatesController.pluginConfig['outputSchema']"
          plugins="TemplatesController.pluginConfig.properties"
          ng-if="TemplatesController.pluginName === 'Stream' || TemplatesController.pluginName === 'Kafka'"
        ></my-stream-properties>
      </fieldset>

    </div>
  </div>

</div>
